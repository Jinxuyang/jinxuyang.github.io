<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="alternate" type="application/rss+xml" title="Verge's Blog" href="https://jysperm.me/atom.xml"><link rel="stylesheet" href="/styles.css"><title>Verge's Blog</title><meta name="generator" content="Hexo 4.2.1"></head><body><div class="container"><div class="columns page-header"><h1>Verge's Blog</h1></div><div class="columns"><div class="navigation"><nav class="menus-main"><a href="/" class="favicon"><img alt="Verge's Blog" src="/favicon.png"></a><a href="/">Home</a></nav><nav class="right menus-right"><a href="/atom.xml">RSS</a><a target="_blank" href="hexo-theme-simpleblock">fork on Github</a></nav></div></div><div class="columns"><div class="block-body column three-fourths"><div class="article-widget"><a href="https://github.com/jysperm/hexo-theme-simpleblock" target="_blank" rel="noopener">与精子同款的博客主题 simpleblock 现已发布！</a></div><article><header><h2><a href="/2020/07/28/yiban-autocheck/">yiban_autocheck</a></h2></header><div class="article-meta clearfix"><time class="left">2020-07-28</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">
需要用到的工具

HttpCanary

## 抓包

1. 先进入易班，然后退出登录，方便我们一会记录整个登录和打卡的过程
2. 打开HttpCanary将易班添加为目标程
3. 开始抓包
4. 完成从登录易班到打卡完成的整个过程的抓包

## 分析

我们倒着来分析

1. 抓到了很多数据包，但是音频和图片js...文件是我们不需要的，因此进行过滤保留这三种数据包即可

2. 开始一个一个分析，发现一个数据包很可疑，打开一看这不就是我们提交的表单吗

3. 验证猜想，重发这个请求，返回消息如下，可以确定这就是我们要找的数据包

4. 猜想是否可以依靠每天自动重发这个请求实现签到，答案是否定的，是什么原因呢

   1. 分析该请求的请求头，发现这里有一个Cookie，有两个字段

      <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">client&#x3D;android</span><br><span class="line">PHPSESSID&#x3D;96098a2d53fdfef072b13f7113da5e17</span><br></pre></td></tr></table></figure>

   2. 第一个不用说，第二个就是罪魁祸首，一看这名字就知道肯定和SESSION有关，百度一下

5. 好了这下目标明确，寻找是谁第一次Set了这个Cookie，筛选，好了就是他，理论上我们只要，发送一下这个请求就可以拿到Cookie

6. 问题又来了，这些又是啥？？？继续往下看

7. 首先猜测一下这个act=iappxxxxx应该是易班小程序的ID，那么OK，他是不会变的，记住就行了，那么这个v是什么？看了看他的前一个请求发现就是access_token

8. 好了继续寻找access_token

9. 拉到最下面，第一个请求应该就是登录的请求，查看他的响应信息果然access_token就在里面

10. 至此，抓包数据分析完成

**总结：**

1. 登录拿到access_token
2. 拿着access_token去获得Cookie
3. 拿着Cookie提交表单
4. 完成

## 代码

**以下使用java，使用Hutool进行Http请求、json解析等等等**

获取Access_token

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CommonResult <span class="title">getAccess_token</span><span class="params">(String username, String password)</span></span>&#123;</span><br><span class="line">        <span class="comment">//设置请求参数</span></span><br><span class="line">        HashMap&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"account"</span>,username);</span><br><span class="line">        map.put(<span class="string">"passwd"</span>,password);</span><br><span class="line">        map.put(<span class="string">"ct"</span>,<span class="number">1</span>);</span><br><span class="line">        map.put(<span class="string">"identify"</span>,<span class="number">0</span>);</span><br><span class="line">        map.put(<span class="string">"v"</span>,<span class="string">"4.7.4"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取返回的字符串</span></span><br><span class="line">        String jsonStr = HttpUtil.get(<span class="string">"https://mobile.yiban.cn/api/v2/passport/login"</span>,map);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//把获取到的字符串转换为JSONObject对象</span></span><br><span class="line">        JSONObject jsonObject = JSONUtil.parseObj(jsonStr);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//try catch一下，以防获取到一些奇奇怪怪的东西</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//比较状态码，是否登陆成功</span></span><br><span class="line">            <span class="keyword">if</span> (jsonObject.get(<span class="string">"response"</span>).equals(<span class="string">"100"</span>))&#123;</span><br><span class="line">                String res = ((JSONObject) jsonObject.get(<span class="string">"data"</span>)).getStr(<span class="string">"access_token"</span>);</span><br><span class="line">                <span class="keyword">return</span> CommonResult.success(res,<span class="string">"拿到数据了"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> CommonResult.failed(<span class="string">"登录失败"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> CommonResult.failed(<span class="string">"易班返回的Json数据可能有变化"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

获取Cookie

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CommonResult <span class="title">getPHPSESSID</span><span class="params">(String access_token)</span></span>&#123;</span><br><span class="line">        <span class="comment">//请求数据</span></span><br><span class="line">        HashMap&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"act"</span>,<span class="string">"iapp610661"</span>);</span><br><span class="line">        map.put(<span class="string">"access_token"</span>,access_token);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//发送请求，从cookie中获取PHPSESSIONID</span></span><br><span class="line">        HttpResponse response = HttpRequest</span><br><span class="line">                .get(<span class="string">"http://f.yiban.cn/iapp/index"</span>)</span><br><span class="line">                .form(map)</span><br><span class="line">                .setFollowRedirects(<span class="keyword">true</span>)</span><br><span class="line">                .execute();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String res = response.header(<span class="string">"Set-Cookie"</span>);</span><br><span class="line">            <span class="keyword">return</span> CommonResult.success(res,<span class="string">"成功获取SESSID"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NullPointerException e) &#123;</span><br><span class="line">            System.out.println(response.toString());</span><br><span class="line">            <span class="keyword">return</span> CommonResult.failed(<span class="string">"没获取到SESSID"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

提交表单

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CommonResult <span class="title">submit</span><span class="params">(String cookie, String content)</span></span>&#123;</span><br><span class="line">        HttpResponse response = HttpRequest.post(<span class="string">"http://yiban.sust.edu.cn/v4/public/index.php/Index/form/add.html?id=9"</span>)</span><br><span class="line">                .contentType(<span class="string">"application/x-www-form-urlencoded"</span>)</span><br><span class="line">                .body(content)</span><br><span class="line">                .cookie(cookie)</span><br><span class="line">                .execute();</span><br><span class="line">        JSONObject jsonObject = JSONUtil.parseObj(response.body());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (jsonObject.get(<span class="string">"code"</span>).equals(<span class="string">"1"</span>))&#123;</span><br><span class="line">                <span class="keyword">return</span> CommonResult.success(jsonObject.getStr(<span class="string">"msg"</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> CommonResult.failed(jsonObject.getStr(<span class="string">"msg"</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NullPointerException e)&#123;</span><br><span class="line">            <span class="keyword">return</span> CommonResult.failed(e.getMessage()+  <span class="string">"没找到返回的code，奇了怪了"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

发送邮件(不得不说Hutool就是好用)

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MailUtil.send(<span class="string">"你的邮箱"</span>,标题,内容,是否为html(<span class="keyword">boolean</span>));</span><br></pre></td></tr></table></figure>

</div></article><article><header><h2><a href="/2020/07/21/algorithm/">算法学习笔记</a></h2></header><div class="article-meta clearfix"><time class="left">2020-07-21</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">
[TOC]

## 枚举

- 一一列举
- 不重复，不遗漏

### 优化枚举的基本思路

减少枚举次数

- 选择合适的枚举对象
- 选择合适的枚举方向 ——方便排除非法和不是最优的情况
- 选择合适的数据维护方法 ——转化问题



#### 例1.最大正方形

题目

在一个N*N（N<100）的矩阵中求一个最大的正方形使得该正方形的四个顶点是由“#”构成

##**#

\*\****

\*\*##*

#\*#\*#*

\*#\*#*

思路

1. 几个点可以确定一个正方形？
   - 对角线上的两个点确定一个正方形
2. 明确思路使用枚举法，枚举所有两个点的组合，判断剩下两个点是否是#，是的话记录面积不是就继续枚举下一个组合，直至枚举完所有集合

### 前缀和

对于一个数列，再开一个数组，第n个数就存前n个数字的和

#### 例2 数列求和问题

给定一个数列{an}（1<= n <= 100000）,有q（1<= n <= 100000）次询问，每次询问从i到j的元素之和

**思路**

1. 暴力，直接算（范围大的话必超时）
2. 先便利数据，求前缀和，存到数组中
3. 使用时直接求aj-ai即可

### 差分

#### 例3 数列修改问题

给定一个数列{an}（1<= n <= 100000）,有q（1<= n <= 100000）次修改，每次修改把从i到j的每个元素加上k，求所有修改之后的每个数值

**思路**

1. 暴力，每次修改都遍历区间（时间复杂度太大）
2. 思考问题，进行修改时区间什么没有变，什么变了
   1. 区间内各个元素之间的差值未变
   2. 端点处的差值改变
3. 把修改的地方从整个区间变到区间的端点，就可以大大减少时间复杂度
   1. 当我们对第i到j个数加上k的话，i与i-1的差值增加了k，j与j加一的差值减少了k，区间内部相邻两数差值不变
   2. 因此可以使用一个数组来维护第i个数和第i-1个数的差值（默认第一个数的前一个数是0），将[i,j]这个区间的每个数+1时，只需要修改i和j+1（i+k，j+1-k）
   3. 对这个数组求前缀和，即可得到数列的值
   4. 这种方法叫**差分**

### 差分与前缀和的关系

差分和前缀和是一对对称的操作

差分数组求前缀和就是原数组，对前缀和求差分也能得到原数组

### 尺取法

给定长度为n的正整数数列以及整数S，求出总和不小于S的连续子串的长度的最小值，如果接不存在，输出0

1. 暴力，枚举两个点的所有组合，选择和大于等于S的最短子串（时间复杂度爆炸）（O（n3））
2. 优化，使用前缀和省去计算和的那一步复杂度变为（O（n2）），依然不低
3. 使用尺取法（O（n））
   1. 确定两个端点，从数组0开始
   2. 首先向右移动右边的端点，判断和是否大于S，若大于S就移动左边的端点，一直移动直至再移动一次就不大于S时，记录长度
   3. 继续移动右端点，重复2，直至数组结束
   4. 得出最小距离



## 贪心

1. 对问题求解时，总是做出在当前看来最好的选择，不从整体上考虑，做出的选择是局部是上最优解
2. 使用贪心算法解决的问题都是能够证贪心出的局部最优解是所求的全局最优解

## STL

### 算法类

- **sort(beg,end,comp)**给数组排序，返回排号的数组,cmp可以不写，comp用来定义比较方法

  - ```c++
    int a[10]= {1, 5, 8, 9, 6, 7, 3, 4, 2, 0};
    sort(a, a+10);
    //两个参数，第一个是你要排的的开始位置的指针，第二个是结束处的指针的下一位
    //可以理解为从a开始，要排几位
    //STL遵循[a,b)原则，因此是a到a+10
    ```

- **search**
  
  - **binary_search(起始地址，结束地址，要查找的值)**，返回布尔值，匹配返回true
  - **lower_bound(beg,end,val)**返回可插入的最小位置的迭代器（可以理解为指针）
    - 例插入3
    - 1 2 2 2 (可以被插到这) **3** 3 3 4 5
    - 返回加粗3处的指针
    - 第一个**大于等于**你查询的数的位置
  - **upper_bound(beg,end,val)**返回可插入的最大位置的迭代器（可以理解为指针）
    - 1 2 2 2  3 3 3 (可以被插到这) **4** 5
    - 返回加粗4处的指针
    - 第一个**大于**你查询的数的位置
  - **使用前数组一定要排序**
- **find(beg,end,val)**返回val第一次出现的地址
- **count(beg,end,val)**返回val的出现次数 返回一个**ptrdiff_t**(typedef long long ptrdiff_t)我也不知道这是个啥
- **swap(a,b)**交换两个数
- 

## 二分、三分

### 二分查找

</div></article><article><header><h2><a href="/2020/06/22/MyBatis/">MyBatis学习笔记</a></h2></header><div class="article-meta clearfix"><time class="left">2020-06-22</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">
[TOC]





## 环境搭建

1. 创建实体类和实体类的接口
   1. User
   2. IUserDao
   
2. 配置主配置文件

   SqlMapConfig.xml

   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置 mybatis 的环境 default属性没有固定的值 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置 mysql 的环境 这里的ID需要和environments标签中的default属性相同--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"mysql"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 配置事务的类型 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 配置连接数据库的信息：用的是数据源(连接池) --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://121.36.19.47:3306/mybatis_learn"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">""</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 告知 mybatis 映射配置的位置 每个Dao独立的配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"dao/IUserDao.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

   

3. 创建映射配置文件

   1. IUserDao.xml

      <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- namespace写类的全限定类名 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"dao.IUserDao"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置查询所有操作 ID填写方法名 resultType填写要封装成的JavaBean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultType</span>=<span class="string">"domain.User"</span>&gt;</span></span><br><span class="line">        select * from user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

      

**注意**：

1. MyBatis的映射配置文件位置必须和Dao接口的包结构相同
2. 映射配置文件的mapper标签的namespace属性取值必须是Dao接口的全限定类名
3. 映射配置文件的操作配置，id属性的取值必须是dao接口的方法名



​	遵从这三点，在开发中就无需实现IUserDao的类，MyBatis代替我们完成



## 使用

1. 读取配置文件

   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">InputStream in = Resources.getResourceAsStream(<span class="string">"SqlMapConfig.xml"</span>);</span><br></pre></td></tr></table></figure>

   

2. 创建SqlSessionFactory工厂

   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SqlSessionFactoryBuilder builder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">SqlSessionFactory factory = builder.build(in);</span><br></pre></td></tr></table></figure>

   

3. 创建SqlSession对象

   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session = factory.openSession();</span><br></pre></td></tr></table></figure>

   

4. 创建Dao接口的代理对象

   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IUserDao userDao = session.getMapper(IUserDao<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure>

5. 释放资源

   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">session.close();</span><br><span class="line">in.close();</span><br></pre></td></tr></table></figure>

   

## 注解使用

1. 省略映射配置文件

2. 在要实现的接口上写

   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">"Sql语句"</span>)</span><br></pre></td></tr></table></figure>

3. 主配置文件\<mapper>标签下使用class属性指定被注解的Dao全限定类名

   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"dao.IUserDao"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

   

## CURD

### 增

#### 配置文件写法

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser"</span> <span class="attr">parameterType</span>=<span class="string">"domain.User"</span>&gt;</span></span><br><span class="line">	INSERT INTO user(username,sex,address) VALUS(#&#123;username&#125;,#&#123;sex&#125;,#&#123;address&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

#### 注解写法



 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Insert</span>(<span class="string">"INSERT INTO user(username,sex,address) VALUS(#&#123;username&#125;,#&#123;sex&#125;,#&#123;address&#125;)"</span>)</span><br></pre></td></tr></table></figure>



需要向接口中传入一个User对象

最后需要commit

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.commit();</span><br></pre></td></tr></table></figure>

#### 获取插入数据的ID

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser"</span> <span class="attr">parameterType</span>=<span class="string">"domain.User"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span> <span class="attr">keyColumn</span>=<span class="string">”id“</span> <span class="attr">resultType</span>=<span class="string">"int"</span> <span class="attr">order</span>=<span class="string">"AFTER"</span>&gt;</span></span><br><span class="line">        SELECT last_insert_id();</span><br><span class="line">    <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">	INSERT INTO user(username,sex,address) VALUS(#&#123;username&#125;,#&#123;sex&#125;,#&#123;address&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

keyProperty表示返回值的名称 

order表示执行该命令的时间，AFTER表示插入之后再执行



### 改、删

与增加操作类似只需要改变标签名称或注解的@Xxx

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"Xxx"</span> <span class="attr">parameterType</span>=<span class="string">"xx.xx"</span>&gt;</span></span><br><span class="line">	Sql语句</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"Xxx"</span> <span class="attr">parameterType</span>=<span class="string">"xx.xx"</span>&gt;</span></span><br><span class="line">	Sql语句</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Update</span>(<span class="string">"...."</span>)</span><br><span class="line"><span class="meta">@Delete</span>(<span class="string">"...."</span>)</span><br></pre></td></tr></table></figure>

### 查



### 获取用户总记录的条数

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findTotal"</span> <span class="attr">resultType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">	SELECT count(id) FROM user;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



## OGNL表达式

Object Graphic Navigation Language

## 连接池与事务控制

### MyBatis中的连接池

mybatis中提供了3种方式配置

在SqlMapConfig.xml中的dataSource标签中，type属性就是配置采用何种连接池的方式

- POOLED		采用传统javax.sql.DataSource规范中的连接池
- UNPOOLED  虽然实现了javax.sql.DataSource，但没有使用池的思想
- JNDI

### 事务

可以在创造SqlSession对象时，给OpenSession中传一个true，就可以实现自动提交

## 动态SQL语句

### \<if>标签

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUser"</span> <span class="attr">resultType</span>=<span class="string">"domain.User"</span> <span class="attr">parameterType</span>=<span class="string">"domain.User"</span>&gt;</span></span><br><span class="line">    SELECT * FROM user WHERE 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username != NULL"</span>&gt;</span></span><br><span class="line">    	AND username = #&#123;username&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"..."</span>&gt;</span></span><br><span class="line">    	AND ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

### \<where>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUser"</span> <span class="attr">resultType</span>=<span class="string">"domain.User"</span> <span class="attr">parameterType</span>=<span class="string">"domain.User"</span>&gt;</span></span><br><span class="line">    SELECT * FROM user</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"username != NULL"</span>&gt;</span></span><br><span class="line">    	AND username = #&#123;username&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"..."</span>&gt;</span></span><br><span class="line">    	AND ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

## 多表查询

I don't have a favorite singer, but a film soundtrack composer whose name is hans zimmer is my favorite composer. I know him from a film called Interstellar. At the same time, Interstellar is also my favorite film. It is because of this excellent OST that there are such excellent film。

Let's enjoy it together</div></article><article><header><h2><a href="/2020/06/01/DataSource/">数据库连接池</a></h2></header><div class="article-meta clearfix"><time class="left">2020-06-01</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">
## 什么是数据库连接池

数据库连接池就是一个存放数据库连接的容器

当系统初始化完成后，容器就被创建，容器中会申请一些连接对象，当用户来访问数据时，从容器中获取连接对象，用户访问完后，将连接对象归还给容器

## 实现

1. 接口：DataSource
   1. 方法
      - 获取连接：getConnection()
      - 归还连接：Connection.close()
        - 如果连接是从数据库连接池中获得的就归还给连接池，而不是关闭连接
   2. 由数据库厂商实现\
      1. 数据库连接池技术
         1. C3P0
         2. Druid

## C3P0

### 使用

1. 导入jar包
2. 定义配置文件：
   1. c3p0.properties/c3p0-config.xml
   2. 放在src文件夹下
   3. 创建核心对象 数据库连接池对象 ComboPooledDataSource( )

## Druid

### 使用

1. 导入jar包
2. 配置文件
   1. xxx.properties
   2. 可以叫任意名称，放在任意目录下
3. 加载配置文件
   1. Properties
4. 数据库连接池对象 DruidDataSourceFactory 
   1. 参数：字节流对象
   2. 方法：createDataSource获取一个DataSource对象



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Properties pro = <span class="keyword">new</span> Properties();</span><br><span class="line">            pro.load(DruidUtils.class.getClassLoader().getResourceAsStream("druid.properties"));</span><br><span class="line">            dataSource = DruidDataSourceFactory.createDataSource(pro);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


</div></article><article><header><h2><a href="/2020/06/01/cookie-session/">cookie&amp;session</a></h2></header><div class="article-meta clearfix"><time class="left">2020-06-01</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">
## 会话

### 什么是会话

一次会话中包含多次请求和响应

一次会话：浏览器第一次给服务器发送请求，会话建立，指导一方断开为止

### 有什么用

在一次会话范围内的多次请求共享数据

### 怎么实现 

1. 客户端会话技术（数据存放在客户端）：Cookie
2. 服务端会话技术（数据存放在服务端）：Session

## Cookie

### 如何使用

1. 创建Cookie对象】
   1. new Cookie(String name,String value)
2. 发送Ciookie对象
   1. response.addCookie(Cookie cookie)
3. 获取Cookie
   1. Cookie[] request.getCookies()



### 原理

- 基于请求头Cookie和响应头Set-Cookie实现

### 细节

1. 一次可以发送多个Cookie（创建多个Cookie对象，多次调用AddCookie）
2. Cookie可以保存多长时间
   1. 默认情况下，浏览器关闭后Cookie销毁
   2.  持久化存储
      1. setMaxAge(int seconds)
         1. 正数，将Cookie数据写道硬盘中，设置Cookie存货时间，单位s
         2. 负数，默认值，结束会话删除
         3. 0，删除Cookie信息

3. Cookie的获取范围
   1. 

### 特点和作用

1. cookie储存在客户端
2. 浏览器对于单个Cookie大小有限制4kb，对一个域名下总cookie数量有限制20个



1. 

## Session

### 使用

1. 获取HttpSession对象(域对象)
   1. request.getSession()

2. 方法
   1. Object getAttribute(String name)
   2. void setAttribute(String name,Object value)
   3. void removeAttribute(String name)

### 原理

Session的实现依赖于Cookie

首次使用时服务器向浏览器发送一个Cookie包含一个JSESSIONID，再次访问时，浏览器向服务器发送JSESSIONID，服务器通过这个ID，确保两次访问使用的是同一个HttpSeesion对象

### 细节

1. 客户端关闭服务器不关闭，两次访问不是同一个Session
   1. 若需要相同可以设置Cookie的存活时间
2. 服务器关闭客户端不关闭，两次访问不是同一个Session
   1. session钝化：
   2. session活化
3. Session失效时间
   1. 服务器关闭
   2. 调用一个自杀方法
   3. 默认失效时间30min



### 特点

1. 存储一次会话的数据，存在服务端
2. 可以存储任意类型数据，任意大小
3. 比Cookie安全</div></article><article><header><h2><a href="/2020/05/31/XML/">XML</a></h2></header><div class="article-meta clearfix"><time class="left">2020-05-31</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">
## 什么是XML

XML(Extensible Markup Language)**可扩展**标记语言

可扩展：标签都是可以自定义的

语法严格

## 啥用

1. 存储数据
   1. 配置文件
   2. 在网络中传输

## 基本语法

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span> version = <span class="string">'1.0'</span> <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">users</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">user</span> <span class="attr">id</span> = <span class="string">'1'</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">age</span>&gt;</span>18<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">user</span> <span class="attr">id</span> = <span class="string">'2'</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">age</span>&gt;</span>18<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">users</span>&gt;</span></span><br></pre></td></tr></table></figure>

1. 第一行必须为版本声明（必须是第一行，第一行是空行都不行）
2. 有且只能有一个根标签(\<users>\</users>)
3. 属性值必须用 引号引起来（单双都行）
4. 标签都是成对出现（除首行）
5. 标签名称区分大小写

</div></article><article><header><h2><a href="/2020/05/30/Spring/">Spring</a></h2></header><div class="article-meta clearfix"><time class="left">2020-05-30</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">


[TOC]



## IoC(控制反转)

将对象的创建交给框架

目的：降低程序间的耦合

### 如何使用

1. Maven项目引入一下依赖

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

2. 在项目的src文件下创建bean.xml(可以是任何名称文件

   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

3. 配置bean标签

   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- bean标签：用于配置让spring创建对象，并且存入ioc容器之中 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- id属性：对象的唯一标识。 class属性：指定要创建对象的全限定类名 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"xxx"</span> <span class="attr">class</span>=<span class="string">"com.xxx.xxx.xxx"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

4. 创建对象

   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123; </span><br><span class="line">    <span class="comment">//1.使用ApplicationContext接口获取spring容器 </span></span><br><span class="line">    ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"bean.xml"</span>); </span><br><span class="line">    <span class="comment">//2.根据bean的id获取对象 </span></span><br><span class="line">    Object ObjectName = (Object) ac.getBean(<span class="string">"bean.xml里的id"</span>); </span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

#### BeanFactory与ApplicationContext

BeanFactory是顶层接口

ApplicationContext是BeanFactory的子接口

不同：对象的创建时间不同

- BeanFactory 什么时候用什么时候创建
- ApplicationContext默认情况下读取完配置文件之后就创建 （**一般用它**）

#### ApplicationContext的实现类

- ClassPathXmlApplicationContext：
它是从类的根路径下加载配置文件 推荐
- FileSystemXmlApplicationContext：
它是从磁盘路径上加载配置文件，配置文件可以在磁盘的任意位置。
- AnnotationConfigApplicationContext:
当我们使用注解配置容器对象时，需要使用此类来创建spring 容器。它用来读取注解。

#### Bean标签

**属性：**

1. 作用
   1. 用于配置对象让Spring创建
   2. 默认调用对象的无参构造器构造
2. 属性
   1. id:给对象指定唯一标识符
   2. class：指定对象的全限定类名
   3. scope：指定对象的作用范围
      1. singleton :默认值，单例的. 
      2. prototype :多例的.  
      3. request :WEB项目中,Spring创建一个Bean的对象,将对象存入到request域中. 
      4. session :WEB项目中,Spring创建一个Bean的对象,将对象存入到session域中. 
      5. global session :WEB项目中,应用在Portlet环境.如果没有Portlet环境那么globalSession相当于session.
   4. init-method：指定类中的初始化方法名称 
   5. destroy-method：指定类中销毁方法名称

#### 实例化Bean

1. 使用默认无参构造函数

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"Xxx"</span> <span class="attr">class</span>=<span class="string">"xxx.xxx.xxx.Xxx"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

2. 使用静态工厂

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticFactory</span> </span>&#123; </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Xxx <span class="title">name</span><span class="params">()</span></span>&#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Xxx(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 此种方式是: 使用StaticFactory类中的静态方法name创建对象，并存入spring容器 </span></span><br><span class="line"><span class="comment">id属性：指定bean的id，用于从容器中获取 </span></span><br><span class="line"><span class="comment">class属性：指定静态工厂的全限定类名 </span></span><br><span class="line"><span class="comment">factory-method属性：指定生产对象的静态方法 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"xxx"</span> <span class="attr">class</span>=<span class="string">"xxx.xxx.xxx.StaticFactory"</span> <span class="attr">factory-method</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

3. 实例工厂

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InstanceFactory</span> </span>&#123; </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Xxx <span class="title">name</span><span class="params">()</span></span>&#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Xxx(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 此种方式是： 先把工厂的创建交给spring来管理。 然后在使用工厂的bean来调用里面的方法 </span></span><br><span class="line"><span class="comment">factory-bean属性：用于指定实例工厂bean的id。 </span></span><br><span class="line"><span class="comment">factory-method属性：用于指定实例工厂中创建对象的方法。 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"instancFactory"</span> <span class="attr">class</span>=<span class="string">"xxx.xxx.xxx.InstanceFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span><span class="comment">&lt;!--工厂类--&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"xxx"</span> <span class="attr">factory-bean</span>=<span class="string">"instancFactory"</span> <span class="attr">factory-method</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span> <span class="comment">&lt;!--工厂中的方法--&gt;</span></span><br></pre></td></tr></table></figure>



### 依赖注入

理解控制反转和依赖注入：https://zhuanlan.zhihu.com/p/33492169

#### 构造函数注入

使用类中的构造函数，给成员变量赋值

 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">constructor-arg :</span></span><br><span class="line"><span class="comment">	属性：</span></span><br><span class="line"><span class="comment">		index:指定参数在构造函数参数列表的索引位置，从0开始</span></span><br><span class="line"><span class="comment">		type:指定参数在构造函数中的数据类型</span></span><br><span class="line"><span class="comment">		name:指定参数在构造函数中的名称</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		value:它能赋的值是基本数据类型和String类型</span></span><br><span class="line"><span class="comment">		ref:它能赋的值是其他bean类型，也就是说，必须得是在配置文件中配置过的bean</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"张三"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"18"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"birthday"</span> <span class="attr">ref</span>=<span class="string">"now"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"now"</span> <span class="attr">class</span>=<span class="string">"java.util.Date"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

#### set方法注入

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 通过配置文件给bean中的属性传值：使用set方法的方式 (常用)</span></span><br><span class="line"><span class="comment">property</span></span><br><span class="line"><span class="comment">	属性： </span></span><br><span class="line"><span class="comment">		name：找的是类中set方法后面的部分 </span></span><br><span class="line"><span class="comment">		ref：给属性赋值是其他bean类型的 </span></span><br><span class="line"><span class="comment">		value：给属性赋值是基本数据类型和string类型的 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"test"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"21"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"birthday"</span> <span class="attr">ref</span>=<span class="string">"now"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"now"</span> <span class="attr">class</span>=<span class="string">"java.util.Date"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

#### 注入集合属性

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.itheima.service.impl.AccountServiceImpl"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 在注入集合数据时，只要结构相同，标签可以互换 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 给数组注入数据 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"myStrs"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 注入 list 集合数据 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"myList"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 注入 set 集合数据 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mySet"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>AAA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 注入 Map 数据 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"myMap"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"testA"</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"testB"</span>&gt;</span>bbb<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 注入 properties 数据 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"myProps"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"testA"</span> <span class="attr">value</span>=<span class="string">"aaa"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"testB"</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">value</span>&gt;</span>bbb<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

## AOP

## 注解

 ### 创建对象

@Component

​	用于把当前类对象存入Spring容器种，相当于配置文件里的\<bean>\</bean>

这个注解有一个属性value用于指定bean的id，默认值为当前类名，首字母小写

@Controller @Service @Repository  这三个注解的作用和属性与@Component相同，只是提供了更加明确的语义化  

### 注入数据

相当于\<property name="" ref="">  

**@AutoWired** 自动按照类型注入  

使用注解注入属性时， set 方法可以省略

当有多个类型匹配时，使用要注入的对象变量名称作为 bean 的 id，在 spring 容器查找    

**@Qualifier**  在自动按照类型注入的基础之上，再按照 Bean 的 id 注入。 

给字段注入时不能独立使用，必须和@Autowire 一起使用;给方法参数注入时，可以独立使用。  

属性：value，bean 的id

**@Resource**  直接按照 Bean 的 id 注入 

属性：value，bean 的id

**@Value**  注入基本数据类型和 String 类型数据的  

value：用于指定值  </div></article><article><header><h2><a href="/2020/05/30/JDBC/">JDBC学习笔记</a></h2></header><div class="article-meta clearfix"><time class="left">2020-05-30</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">
### JDBC是啥

JDBC(Java DataBase connectivity)(Java 数据库连接)

由SUN公司定义的一系列操作关系型数据库的接口，后由数据库厂商对接口进行实现，提供数据库驱动jar包

##  使用

### 导入jar包

 

### 加载驱动

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);<span class="comment">//把com.mysql.jdbc.Driver这个字节码文件加载到内存里</span></span><br></pre></td></tr></table></figure>

### 连接数据库

`host = jdbc:mysql://host /db`

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection conn = DriverManager.getConnection(host,username,passwd);</span><br></pre></td></tr></table></figure>

连接时发现报错

> The server time zone value '�й���׼ʱ��' is unrecognized or represents more than one time zone. You must configure either the server or JDBC driver (via the serverTimezone configuration property) to use a more specifc time zone value if you want to utilize time zone support.

解决方法

host后加上`?serverTimezone=UTC`

## 对象详解

1. DriverManage驱动管理
   - 注册驱动
     - MySQL5以后可以自动注册
   - 获取数据库连接
     - static getConnection(String url,String user,String password)
     - url = jdbc:mysql://ip地址:端口号/数据库名
2. Connection数据库连接对象
   1. 获取执行sql语句的对象
      -  Statement CreateStatement(String sql)
      - Prestatement prepareStatement(String sql)
   2. 管理事务
3. Statement执行sql语句
   1. 执行sql
      1. int executeUpdate(String sql)：执行DML(insert,update,delete)，DDL(create,alter,drop)
         - 返回值是操作后影响的行数
         - 可以用来判断成功与否
      2. ResultSet executeQuery(String sql):执行DQL(select)
4. ResultSet查询结果的封装
   - boolean next()游标向下移动一行(默认指向表头)，判断是否有数据
   - getXxx("列名/列的编号，从1开始")获取数据Xxx代表类型
5. PreparedStatement
   1. SQL注入问题:在拼接sql‘语句时，有一些特殊的词参与拼接会造成安全问题
   2. 使用PreparedStatem对象解决问题
      1. 定义sql语句时使用`?`作为占位符，替换参数
      2. 使用setXxx(？的编号从1开始，参数的值)
      3. 执行sql语句时不再需要传参

## Spring JDBC

Spring框架提供的JDBC简单封装

提供一个JDBCTemplate

### 使用

1. 导入jar包
2. 创建JdbcTemplate，依赖于DataSource
   1. JdbcTemplate template = new JdbcTemplate
3. 调用JdbcTemplate的方法完成CRUD操作
   1. update()增删改
   2. queryForMap()将查询结果封装为map集合
   3. queryForList()将查询结果封装为list集合
   4. query()查询结果，将查询结果封装为JavaBean对象
   5. queryForObject()将查询结果封装为对象

</div></article><article><header><h2><a href="/2020/05/30/Servlet/">Servlet学习笔记</a></h2></header><div class="article-meta clearfix"><time class="left">2020-05-30</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">
[TOC]

## 什么是Servlet

Servlet(Service applet)运行在服务器的小程序

Servlet就是一个**接口**，定义了某个Java类能被tomcat识别的规则

### 如何使用

1. 新建一个类
2. 实现servlet的接口
3. 实现接口中的抽象类
4. 配置servlet

## Servlet的执行流程

![](https://i.loli.net/2020/05/30/zigWGXkjAqUTQS6.png)

## Servlet基础

### 配置Servlet

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>Servlet的地址<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>访问Servlet的地址<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

当

### Servlet启动时自动装载

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">//加上这些代码</span><br><span class="line">    <span class="tag">&lt;<span class="name">loadon-startup</span>&gt;</span>num<span class="tag">&lt;/<span class="name">loadon-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>

num越小优先级越高

### 使用注解

`@WebServlet("url")`

就不用在web.xml里面配置了



### 声明周期

第一次访问后，servlet创建，第二次访问时不需要创建，直接使用，当服务器关闭时，servlet销毁

## Servlet结构

Servlet接口下有两个实现类

HttpServlet和GenericServlet

### GenericServlet

除了service类外，对Servlet接口的其他类都进行了空实现

以后使用Servlet时，对该类进行继承就行

### HttpServlet

对http协议进行了封装，简化操作 

## Request对象

### 继承体系

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ServletRequest --接口</span><br><span class="line">继承</span><br><span class="line">HttpServletRequest --接口</span><br><span class="line">实现</span><br><span class="line">org.apache.catalina.connector.RequestFacade(tomcat实现)</span><br></pre></td></tr></table></figure>

### 获取数据库

#### 获取请求行

1. getMethod获取请求方法
2. **getContextPath取虚拟目录**
3. getServletPath获取Servlet路径
4. getQueryString获取请求参数
5. **获取请求URI**
   1. getRequestURI
   2. getRequestURL
6. getProtocol获取协议版本
7. getRemoteAddr获取客户机IP地址

#### 获取请求头

1. getHeader(String name)通过请求头的名称获得请求头
2. Enumeration\<String> getHeaderNames()获取所有请求头的名称

#### 获取请求体

* 只有POST有请求体

1. 获取流对象
   - BufferReader getReader()获取字符输入流，只能操作字符数据
   - ServletInputStream getInputStream()获取字节输入流，可以操作所有数据类型
2. 从流对象中获取数据

#### 其他（重要）

1. 获取请求参数的通用方式（兼容GET&POST）
   1. String getParameter(String name)根据参数名获取参数值
   2. String[] getParameterValues(String name)根据参数名获取参数值的数组 -- hobby=吃饭&hobby=睡觉
   3. Enumeration\<String> getParameterNames()获取所有请求参数的名称
   4. Map<String,String[]> getParameterMap()获取所有参数的map集合

2. 请求转发

   1. 步骤

      1. 通过request对象获取请求转发器对象：RequestDispatcher get RequestDispatcher(String path)

      2. 使用RequestDispatcher对象进行转发：forward(ServletRequest request,ServletResponse response)

         `request.getRequestDispatcher("/path").forward(request,response)`

   2. 特点

      1. 浏览器地址栏不变化
      2. 只能转发到当前服务器内部资源
      3. 访问带转发是一次请求

3. 共享数据

   - 域对象：一个有作用范围的对象，可以在范围内共享数据

   - request域：代表一次请求的范围，一般用于请求转发的多个资源中共享数据
   - 方法：
     1. void setAttribute(String name,Object obj)存储数据
     2. Object getAttribute(String name):通过键获取值
     3. void removeAttribute(String name):通过键移除键值对

4. 获取ServletContext

   1. </div></article><article><header><h2><a href="/2020/05/06/MySQL%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">MySQL学习笔记</a></h2></header><div class="article-meta clearfix"><time class="left">2020-05-06</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">
### 登录登出

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u用户名 -p密码 -P端口号 -h服务器名称</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql &gt; <span class="built_in">exit</span>;退出</span><br></pre></td></tr></table></figure>

### 修改MySQL提示符

登陆时

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u用户名 -p密码 -P端口号 -h服务器名称 --prompt 提示符</span><br></pre></td></tr></table></figure>

登陆后

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prompt 提示符</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\D完整日期 \d当前数据库 \h服务器名称 \u当前用户</span><br></pre></td></tr></table></figure>

### MySQL常用命令

- 关键字与函数名全部大写
- 数据库名，表名称，字段名称全部小写
- MySQL语句必须以分号结尾

### 创建数据库

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE &#123;DATABASE | SCHEMA&#125; [IF NOT EXISTS] db_name</span><br></pre></td></tr></table></figure>

### </div></article><div class="archive-pagination"><div class="paginator"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">&amp;raquo;</a></div></div></div><div class="block-sidebar column one-fourth"><div class="widget text-content"><p>Simple Block 是一个基于线框设计的简单的 Hexo 主题，拆分自 <a href="https://jysperm.me" target="_blank" rel="noopener">精子的博客</a>。
支持使用 Jade 或 Markdown 来向边栏添加小部件，或向正文前添加横幅。</p>
<p>技术栈：</p>
<ul>
<li>Jade - 页面模板</li>
<li>Less/Sass - 页面样式</li>
<li>Bower - 前端包管理器</li>
<li>CoffeeScript - Hexo 拓展脚本</li>
<li>Gulp - 编译工具</li>
</ul>
</div><div class="widget tags"></div><div class="widget archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">3</span></li></ul></div><div class="widget text-content"><p>该博客使用基于 &nbsp;<a href="http://hexo.io" target="_blank" rel="noopener">Hexo</a>&nbsp; 的 &nbsp;<a href="https://github.com/jysperm/hexo-theme-simpleblock" target="_blank" rel="noopener">simpleblock</a>&nbsp; 主题。博客内容使用 &nbsp;<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn" target="_blank" rel="noopener">CC BY-NC-SA 3.0</a>&nbsp; 授权发布。最后生成于 2020-08-05.</p></div></div></div></div></body></html>