<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="alternate" type="application/rss+xml" title="Verge's Blog" href="https://jysperm.me/atom.xml"><link rel="stylesheet" href="/styles.css"><title>Servlet学习笔记 | Verge's Blog</title><meta name="generator" content="Hexo 4.2.1"></head><body><div class="container"><div class="columns page-header"><h1>Verge's Blog</h1></div><div class="columns"><div class="navigation"><nav class="menus-main"><a href="/" class="favicon"><img alt="Verge's Blog" src="/favicon.png"></a><a href="/">Home</a></nav><nav class="right menus-right"><a href="/atom.xml">RSS</a><a target="_blank" href="hexo-theme-simpleblock">fork on Github</a></nav></div></div><div class="columns"><div class="block-body column three-fourths"><div class="article-widget"><a href="https://github.com/jysperm/hexo-theme-simpleblock" target="_blank" rel="noopener">与精子同款的博客主题 simpleblock 现已发布！</a></div><article><header><small class="right"><a target="_blank" href="null_posts%2FServlet.md">查看源代码</a></small><h1>Servlet学习笔记</h1></header><div class="article-meta clearfix"><time class="left">2020-05-30</time><ul class="tags left"></ul><ul class="tags right"></ul></div><div class="markdown-body">
[TOC]

## 什么是Servlet

Servlet(Service applet)运行在服务器的小程序

Servlet就是一个**接口**，定义了某个Java类能被tomcat识别的规则

### 如何使用

1. 新建一个类
2. 实现servlet的接口
3. 实现接口中的抽象类
4. 配置servlet

## Servlet的执行流程

![](https://i.loli.net/2020/05/30/zigWGXkjAqUTQS6.png)

## Servlet基础

### 配置Servlet

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>Servlet的地址<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>访问Servlet的地址<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

当

### Servlet启动时自动装载

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">//加上这些代码</span><br><span class="line">    <span class="tag">&lt;<span class="name">loadon-startup</span>&gt;</span>num<span class="tag">&lt;/<span class="name">loadon-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>

num越小优先级越高

### 使用注解

`@WebServlet("url")`

就不用在web.xml里面配置了



### 声明周期

第一次访问后，servlet创建，第二次访问时不需要创建，直接使用，当服务器关闭时，servlet销毁

## Servlet结构

Servlet接口下有两个实现类

HttpServlet和GenericServlet

### GenericServlet

除了service类外，对Servlet接口的其他类都进行了空实现

以后使用Servlet时，对该类进行继承就行

### HttpServlet

对http协议进行了封装，简化操作 

## Request对象

### 继承体系

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ServletRequest --接口</span><br><span class="line">继承</span><br><span class="line">HttpServletRequest --接口</span><br><span class="line">实现</span><br><span class="line">org.apache.catalina.connector.RequestFacade(tomcat实现)</span><br></pre></td></tr></table></figure>

### 获取数据库

#### 获取请求行

1. getMethod获取请求方法
2. **getContextPath取虚拟目录**
3. getServletPath获取Servlet路径
4. getQueryString获取请求参数
5. **获取请求URI**
   1. getRequestURI
   2. getRequestURL
6. getProtocol获取协议版本
7. getRemoteAddr获取客户机IP地址

#### 获取请求头

1. getHeader(String name)通过请求头的名称获得请求头
2. Enumeration\<String> getHeaderNames()获取所有请求头的名称

#### 获取请求体

* 只有POST有请求体

1. 获取流对象
   - BufferReader getReader()获取字符输入流，只能操作字符数据
   - ServletInputStream getInputStream()获取字节输入流，可以操作所有数据类型
2. 从流对象中获取数据

#### 其他（重要）

1. 获取请求参数的通用方式（兼容GET&POST）
   1. String getParameter(String name)根据参数名获取参数值
   2. String[] getParameterValues(String name)根据参数名获取参数值的数组 -- hobby=吃饭&hobby=睡觉
   3. Enumeration\<String> getParameterNames()获取所有请求参数的名称
   4. Map<String,String[]> getParameterMap()获取所有参数的map集合

2. 请求转发

   1. 步骤

      1. 通过request对象获取请求转发器对象：RequestDispatcher get RequestDispatcher(String path)

      2. 使用RequestDispatcher对象进行转发：forward(ServletRequest request,ServletResponse response)

         `request.getRequestDispatcher("/path").forward(request,response)`

   2. 特点

      1. 浏览器地址栏不变化
      2. 只能转发到当前服务器内部资源
      3. 访问带转发是一次请求

3. 共享数据

   - 域对象：一个有作用范围的对象，可以在范围内共享数据

   - request域：代表一次请求的范围，一般用于请求转发的多个资源中共享数据
   - 方法：
     1. void setAttribute(String name,Object obj)存储数据
     2. Object getAttribute(String name):通过键获取值
     3. void removeAttribute(String name):通过键移除键值对

4. 获取ServletContext

   1. </div></article></div><div class="block-sidebar column one-fourth"><div class="widget text-content"><p>Simple Block 是一个基于线框设计的简单的 Hexo 主题，拆分自 <a href="https://jysperm.me" target="_blank" rel="noopener">精子的博客</a>。
支持使用 Jade 或 Markdown 来向边栏添加小部件，或向正文前添加横幅。</p>
<p>技术栈：</p>
<ul>
<li>Jade - 页面模板</li>
<li>Less/Sass - 页面样式</li>
<li>Bower - 前端包管理器</li>
<li>CoffeeScript - Hexo 拓展脚本</li>
<li>Gulp - 编译工具</li>
</ul>
</div><div class="widget tags"></div><div class="widget archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">3</span></li></ul></div><div class="widget text-content"><p>该博客使用基于 &nbsp;<a href="http://hexo.io" target="_blank" rel="noopener">Hexo</a>&nbsp; 的 &nbsp;<a href="https://github.com/jysperm/hexo-theme-simpleblock" target="_blank" rel="noopener">simpleblock</a>&nbsp; 主题。博客内容使用 &nbsp;<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn" target="_blank" rel="noopener">CC BY-NC-SA 3.0</a>&nbsp; 授权发布。最后生成于 2020-08-05.</p></div></div></div></div></body></html>